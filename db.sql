-- ARTISTA = TALLER
CREATE TABLE ARTISTA(
    CODIGO INT PRIMARY KEY,
    NOMBRE_ARTISTICO VARCHAR(50) NOT NULL UNIQUE,
    GENERO_MUSICAL VARCHAR(30) NOT NULL,
    NOMBRE_OFICIAL VARCHAR(50),
    NUMERO_INTEGRANTES INT,
    TIPO_ARTISTA VARCHAR(10),
    CHECK(TIPO_ARTISTA IN ('Solista','Grupo')),
    CHECK((TIPO_ARTISTA = 'Solista' AND NOMBRE_OFICIAL IS NOT NULL AND NUMERO_INTEGRANTES IS NULL) 
          OR (TIPO_ARTISTA = 'Grupo' AND NOMBRE_OFICIAL IS NULL AND NUMERO_INTEGRANTES IS NOT NULL)),
    CHECK(CODIGO >= 0),
    CHECK(NUMERO_INTEGRANTES > 1)
);

-- ALBUM = MECANICO

CREATE TABLE ALBUM(
    CODIGO INT PRIMARY KEY,
    TITULO VARCHAR(30) NOT NULL,
    ANO_LANZAMIENTO INT NOT NULL,
    CREDITOS VARCHAR(255) NOT NULL,
    CODIGO_ARTISTA INT NOT NULL,
    FOREIGN KEY (CODIGO_ARTISTA) REFERENCES ARTISTA(CODIGO),
    CHECK(CODIGO >= 0),
    CHECK(CODIGO_ARTISTA >= 0),
    CHECK(ANO_LANZAMIENTO > 0)
);

-- REPARACION = CANCION

CREATE TABLE CANCION(
    CODIGO INT PRIMARY KEY,
    TITULO VARCHAR(30) NOT NULL,
    FECHA_LANZAMIENTO DATE NOT NULL,
    DURACION INT NOT NULL,
    CODIGO_ALBUM INT,
    CODIGO_INSPIRACION INT, 
    FOREIGN KEY(CODIGO_INSPIRACION) REFERENCES CANCION(CODIGO),
    FOREIGN KEY(CODIGO_ALBUM) REFERENCES ALBUM(CODIGO),

    CHECK(CODIGO != CODIGO_INSPIRACION),
    CHECK(CODIGO >= 0),
    CHECK(CODIGO_ALBUM >= 0),
    CHECK(CODIGO_INSPIRACION >= 0),
    CHECK(DURACION >= 0)
);


-- INTO PARA PRUEBAS--
-- INSERTS PARA LA TABLA ARTISTA
-- Se asume que son grupos, por lo que NUMERO_INTEGRANTES se especifica y NOMBRE_OFICIAL se deja NULL

INSERT INTO ARTISTA (CODIGO, NOMBRE_ARTISTICO, GENERO_MUSICAL, NOMBRE_OFICIAL, NUMERO_INTEGRANTES, TIPO_ARTISTA)
VALUES (1, 'The Beatles', 'Rock', NULL, 4, 'Grupo');

INSERT INTO ARTISTA (CODIGO, NOMBRE_ARTISTICO, GENERO_MUSICAL, NOMBRE_OFICIAL, NUMERO_INTEGRANTES, TIPO_ARTISTA)
VALUES (2, 'Queen', 'Rock', NULL, 4, 'Grupo');

INSERT INTO ARTISTA (CODIGO, NOMBRE_ARTISTICO, GENERO_MUSICAL, NOMBRE_OFICIAL, NUMERO_INTEGRANTES, TIPO_ARTISTA)
VALUES (3, 'Coldplay', 'Alternative/Pop Rock', NULL, 4, 'Grupo');


-- INSERTS PARA LA TABLA ALBUM
-- Cada artista tendrá 2 álbumes

-- Álbumes de The Beatles (ARTISTA CODIGO=1)
INSERT INTO ALBUM (CODIGO, TITULO, ANO_LANZAMIENTO, CREDITOS, CODIGO_ARTISTA)
VALUES (1, 'Abbey Road', 1969, 'Produced by George Martin', 1);

INSERT INTO ALBUM (CODIGO, TITULO, ANO_LANZAMIENTO, CREDITOS, CODIGO_ARTISTA)
VALUES (2, 'Sgt. Peppes Lonely', 1967, 'Produced by George Martin', 1);

-- Álbumes de Queen (ARTISTA CODIGO=2)
INSERT INTO ALBUM (CODIGO, TITULO, ANO_LANZAMIENTO, CREDITOS, CODIGO_ARTISTA)
VALUES (3, 'A Night at the Opera', 1975, 'Queen, produced by Roy Thomas Baker', 2);

INSERT INTO ALBUM (CODIGO, TITULO, ANO_LANZAMIENTO, CREDITOS, CODIGO_ARTISTA)
VALUES (4, 'News of the World', 1977, 'Queen', 2);

-- Álbumes de Coldplay (ARTISTA CODIGO=3)
INSERT INTO ALBUM (CODIGO, TITULO, ANO_LANZAMIENTO, CREDITOS, CODIGO_ARTISTA)
VALUES (5, 'Parachutes', 2000, 'Produced by Ken Nelson', 3);

INSERT INTO ALBUM (CODIGO, TITULO, ANO_LANZAMIENTO, CREDITOS, CODIGO_ARTISTA)
VALUES (6, 'A Rush of Blood to the Head', 2002, 'Produced by Ken Nelson', 3);


-- INSERTS PARA LA TABLA CANCION
-- Cada álbum tendrá 2 canciones, y en cada caso la segunda se inspirará en la primera (CODIGO_INSPIRACION)

-- Canciones para el Álbum 1: Abbey Road (The Beatles)
INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (1, 'Come Together', '1969-09-26', 259, 1, NULL);

INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (2, 'Something', '1969-09-26', 182, 1, 1);

-- Canciones para el Álbum 2: Sgt. Pepper's Lonely Hearts Club Band (The Beatles)
INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (3, 'Lucy in the Sky with Diamonds', '1967-06-01', 210, 2, NULL);

INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (4, 'A Day in the Life', '1967-06-01', 330, 2, 3);

-- Canciones para el Álbum 3: A Night at the Opera (Queen)
INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (5, 'Bohemian Rhapsody', '1975-11-21', 354, 3, NULL);

INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (6, 'Love of My Life', '1975-11-21', 220, 3, 5);

-- Canciones para el Álbum 4: News of the World (Queen)
INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (7, 'We Will Rock You', '1977-10-07', 122, 4, NULL);

INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (8, 'We Are the Champions', '1977-10-07', 179, 4, 7);

-- Canciones para el Álbum 5: Parachutes (Coldplay)
INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (9, 'Yellow', '2000-06-26', 269, 5, NULL);

INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (10, 'Trouble', '2000-06-26', 240, 5, 9);

-- Canciones para el Álbum 6: A Rush of Blood to the Head (Coldplay)
INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (11, 'Clocks', '2002-08-26', 305, 6, NULL);

INSERT INTO CANCION (CODIGO, TITULO, FECHA_LANZAMIENTO, DURACION, CODIGO_ALBUM, CODIGO_INSPIRACION)
VALUES (12, 'The Scientist', '2002-08-26', 318, 6, 11);